#!/usr/bin/env php
<?php

declare(strict_types=1);

namespace webignition\TcpCliProxyServer\Bin;

use webignition\TcpCliProxyServer\StreamingServer;

const VERSION = 'dev-master';

$pharPath = \Phar::running(false);

if ('' === $pharPath) {
    require 'vendor/autoload.php';
} else {
    require 'phar://server.phar/vendor/autoload.php';
}

$streamingServer = StreamingServer::create('0.0.0.0', 8000);

pcntl_async_signals(true);
pcntl_signal(SIGINT, function () use ($streamingServer) {
    $streamingServer->stop();
});

$streamingServer->run();
